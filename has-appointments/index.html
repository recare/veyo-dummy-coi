<!DOCTYPE html>
<html lang="en">
<head>

  <meta charset="utf-8">
  <title>Veyo - COI</title>
  <meta name="description" content="">
  <meta name="author" content="">

  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="stylesheet" href="css/app.css">
  <link rel="icon" type="image/png" href="img/favicon.png">

</head>
<body>

  <header>

    <div style="font-weight: 900; font-size: 24px; position: absolute; top: 24px; left: 30px;">veyo</div>

    <nav>

      <ul>
        <li>My Carers</li>
        <li>Invoices</li>
        <li>Notifications <span class="notifications--bullet">1</span></li>
      </ul>

    </nav>

  </header>

  <main>

    <div class="notifications--container">

      <p>
        <strong>Manon Meerkat</strong> accepted your request to assist you with <strong>helping you shop</strong> on <strong>October 18th, 2PM</strong>.
        <span style="margin-top: 20px; display: block;">
          <a href="#" class="highlight">Highlight</a><a href="#" class="dismiss">Dismiss</a><a href="#" style="opacity: .2; color: #000000;">Next</a>
        </span>
      </p>

    </div>

    <div class="calendar--wrapper">
      <div>
        <div class="calendar--container">

          <h1>October</h1>

          <ul>

            <div class="calendar--row--start"></div>

            <div class="calendar--row--days">
              <li class="calendar--day">MON</li>
              <li class="calendar--day">TUE</li>
              <li class="calendar--day">WED</li>
              <li class="calendar--day">THU</li>
              <li class="calendar--day">FRI</li>
              <li class="calendar--day">SAT</li>
              <li class="calendar--day">SUN</li>
            </div>

            <div class="calendar--row">
              <li class="calendar--date__off">28</li>
              <li class="calendar--date__off">29</li>
              <li class="calendar--date__off">30</li>
              <li class="calendar--date__highlight">1</li>
              <li>2</li>
              <li class="calendar--date__highlight">3</li>
              <li>4</li>
            </div>

            <div class="calendar--row">
              <li>5</li>
              <li class="calendar--date__highlight">6</li>
              <li>7</li>
              <li>8</li>
              <li class="calendar--date__highlight">9</li>
              <li class="calendar--date__highlight">10</li>
              <li>11</li>
            </div>

            <div class="calendar--row">
              <li class="calendar--date__highlight">12</li>
              <li>13</li>
              <li class="calendar--date__highlight">14</li>
              <li>15</li>
              <li>16</li>
              <li>17</li>
              <li class="calendar--date__highlight notification--highlight">18</li>
            </div>

            <div class="calendar--row">
              <li>19</li>
              <li class="calendar--date__highlight">20</li>
              <li>21</li>
              <li>22</li>
              <li class="calendar--date__highlight">23</li>
              <li class="calendar--date__highlight">24</li>
              <li>25</li>
            </div>

            <div class="calendar--row">
              <li class="calendar--date__highlight">26</li>
              <li>27</li>
              <li class="calendar--date__highlight">28</li>
              <li>29</li>
              <li class="calendar--date__highlight">30</li>
              <li>31</li>
              <li class="calendar--date__off">1</li>
            </div>

            <div class="calendar--row--end"></div>

          </ul>

        </div>
        <div class="calendar--detail--container">

          <h1 style="display: inline-block;"><span id="day">Day</span>, October <span id="date">11</span></h1>
          <ul style="display: inline-block; list-style: none;">
            <li style="display: inline-block; font-weight: 700;"><a href="#" style="text-decoration: none;">13.00</a> |</li>
            <li style="display: inline-block;"><a href="#" style="text-decoration: none; opacity: .5;">15.30</a> |</li>
            <li style="display: inline-block;"><a href="#" style="text-decoration: none; opacity: .5;">17.30</a></li>
          </ul>
          <div class="calendar--detail--body face--front">

            <a href="#" class="calendar--detail--partner--avatar"><img src="img/tom_turbo.jpg" alt="Tom Turbo Avatar" /></a>
            <h3 class="calendar--detail--partner">Tom Turbo</h3>

            <div class="calendar--detail--partner--actions">
              <span class="actions-call">Call</span>
              <span class="actions-message">Message</span>
            </div>

            <p class="calendar--detail--job">Company at Bingo Night</p>
            <p class="calendar--detail--brief" contenteditable="true" data-placeholder="Click and type here to create an event brief.">Tom will pick me up at <strong>6PM</strong> from <strong>home</strong>. We take a walk of 10 minutes to Oberholz where we stay until <strong>8PM</strong> for Bingo Night. We will then walk home.</p>

            <a href="#" class="calendar--detail--chat">Chat with Tom</a>
          </div>
          <div class="calendar--detail--body face--back">

            <a href="#" class="calendar--detail--partner--avatar"><img src="img/tom_turbo.jpg" alt="Tom Turbo Avatar" /></a>
            <h3 class="calendar--detail--partner">Tom Turbo</h3>

            <p class="calendar--detail--job not-typing"><span>is currently online</span></p>
            <p class="calendar--detail--chat--content no-messages">You haven't written any messages yet.</p>
            <p class="calendar--detail--chat--content--response no-response"></p>
            <input type="text" class="calendar--detail--chat--input" placeholder="Type away!" />
            <a href="#" class="calendar--detail--chat--send">Send</a>
          </div>
        </div>


      </div><!-- empty div -->
    </div><!-- /.calendar--container -->

  </main>
  <button class="reset">Reset</button>

  <footer>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <script>

    var prevUntil = {},
        nextUntil = {},
        calendarRow = $('.calendar--row'),
        calendarRowDays = $('.calendar--row--days'),
        calendarDetail = $('.calendar--detail--container'),
        calendarContainer = $('.calendar--container'),
        calDay = $('#day')[0],
        calDate = $('#date')[0],
        calWeekArray = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
        thisDate = '',
        dateExtension = '',
        calendarItems = $('.calendar--container ul li');

    // item interactions
    calendarItems.on('click', function() {

      thisDate = $(this)[0].innerHTML;
      thisIndex = $(this).index();

      // needs new extension?
      if (thisDate === '1' || thisDate === '21' || thisDate === '31') {

        dateExtension = 'st';
      } else if (thisDate === '2' || thisDate === '22') {

        dateExtension = 'nd';
      } else if (thisDate === '3' || thisDate === '23') {

        dateExtension = 'rd';
      } else {

        dateExtension = 'th';
      }

      // set date
      calDate.innerHTML = $(this)[0].innerHTML + dateExtension;

      // set day
      calDay.innerHTML = calWeekArray[thisIndex];

    });

    // row interactions
    calendarRow.on('click', function() {

      // store everything in vars
      prevUntil = $(this).prevUntil('.calendar--row--start');
      nextUntil = $(this).nextUntil('.calendar--row--end');

      // calendar fade-out
      $(this).removeClass().addClass('calendar--row fade-to-top');
      prevUntil.removeClass().addClass('calendar--row fade-to-top');
      nextUntil.removeClass().addClass('calendar--row fade-to-bottom');

      // detail fade-in
      calendarDetail.removeClass('fade-back-to-place').addClass('is-visible');

      $('.calendar--container h1').addClass('is-hidden');

      calendarContainer.css('z-index', '-1');

    });

    // detect flip end change card size
    $('.face--back').one('webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend', function(e) {

      console.log('stuff');

    });

    // on pressing send remove none class and add first message
    $(document).keypress(function(e) {

      if (e.which == 13) {
        $('.calendar--detail--chat--send').click();
      }
    });

    var messageCount = 0;
    $('.calendar--detail--chat--send').on('click', function() {

      var inputValue = $('input.calendar--detail--chat--input').val();

      if (messageCount === 0) {

        $('.calendar--detail--chat--content').empty();
        $('.calendar--detail--chat--input').attr('placeholder', '');
      }

      $('.calendar--detail--chat--content').removeClass('no-messages').addClass('has-messages');
      $('.calendar--detail--chat--content').append("<span class='animated fadeInUp'>" + inputValue + "</span><br>");

      $('input.calendar--detail--chat--input').val('');

      messageCount++;

      if (messageCount === 2) {

        $('.calendar--detail--job.not-typing').removeClass('not-typing').addClass('is-typing');

        setTimeout(function(){

          $('.calendar--detail--job.is-typing').removeClass('is-typing').addClass('not-typing');

          $('.calendar--detail--chat--content--response').removeClass('no-response').addClass('has-response');
          $('.calendar--detail--chat--content--response').append("<span class='animated fadeInUp'>" + "Hello Emma. Replenishing some vitamin C – good thinking!" + "</span><br>");
        }, 3200);
      }
    });

    // flip card
    $('a.calendar--detail--chat').on('click', function(e) {

      $(this).fadeOut('fast');
      $('.calendar--detail--body').toggleClass('is-flipped');
    });

    $('button.reset').on('click', function() {

      calendarRow.removeClass('fade-to-top fade-to-bottom').addClass('fade-back-to-place');
      calendarRowDays.removeClass('fade-to-top fade-to-bottom').addClass('fade-back-to-place');
      $('.calendar--container h1').removeClass('is-hidden');

      calendarDetail.removeClass('is-visible').addClass('fade-back-to-place');

      calendarContainer.css('z-index', '100');
    });

    $('.calendar--detail--brief').on('focusin', function() {

      $('.calendar--detail--body').addClass('is-focused');
    });

    $('.calendar--detail--brief').on('focusout', function() {

      $('.calendar--detail--body').removeClass('is-focused');
    });

    // Notification interactions
    $('.dismiss').on('click', function() {

      $('.is-transparent').removeClass('is-transparent');
      $('.notifications--bullet').fadeOut('slow');
      $('.notifications--container').fadeOut('slow');
    });

    $('.highlight').on('click', function() {

      $('.calendar--container ul li').not('.notification--highlight').addClass('is-transparent');
    });

    </script>

  </footer>

</body>
</html>
